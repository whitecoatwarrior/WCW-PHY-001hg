<meta name='viewport' content='width=device-width, initial-scale=1'/><meta name='viewport' content='width=device-width, initial-scale=1'/><meta name='viewport' content='width=device-width, initial-scale=1'/><!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WHITE COAT WARRIORS</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* All CSS styles remain the same as in the original file */
        :root {
            --primary-blue: #1a56db;
            --secondary-blue: #0ea5e9;
            --dark-blue: #1e3a8a;
            --light-blue: #dbeafe;
            --accent-green: #10b981;
            --accent-orange: #f59e0b;
            --accent-red: #ef4444;
            --accent-purple: #8b5cf6;
            --accent-pink: #ec4899;
            --accent-teal: #14b8a6;
            --accent-yellow: #fbbf24;
            --accent-amber: #f59e0b;
            --vibrant-blue: #3b82f6;
            --vibrant-green: #22c55e;
            --vibrant-purple: #a855f7;
            --vibrant-pink: #e879f9;
            --gradient-blue: linear-gradient(135deg, var(--primary-blue), var(--secondary-blue));
            --gradient-green: linear-gradient(135deg, var(--accent-green), #34d399);
            --gradient-orange: linear-gradient(135deg, var(--accent-orange), #f97316);
            --gradient-red: linear-gradient(135deg, var(--accent-red), #f87171);
            --gradient-purple: linear-gradient(135deg, var(--accent-purple), #a78bfa);
            --gradient-pink: linear-gradient(135deg, var(--accent-pink), #f472b6);
            --gradient-teal: linear-gradient(135deg, var(--accent-teal), #2dd4bf);
            --gradient-yellow: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
            --gradient-vibrant: linear-gradient(135deg, #4f46e5, #7c3aed, #ec4899);
            --shadow: 0 1px 2px rgba(0, 0, 0, 0.06);
            --shadow-lg: 0 2px 5px rgba(0, 0, 0, 0.08);
            --shadow-xl: 0 5px 15px -3px rgba(0, 0, 0, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #f0f9ff, #e0f2fe);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 6px;
            color: #1e3a8a;
            font-size: 8.25px;
            overflow-x: hidden;
        }

        .container {
            width: 100%;
            max-width: 900px;
            margin: 0 auto;
            position: relative;
        }

        .logo {
            text-align: center;
            margin-bottom: 9px;
        }

        .logo h1 {
            font-size: 1.05rem;
            font-weight: 800;
            color: var(--dark-blue);
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.08);
            margin-bottom: 1.5px;
            background: var(--gradient-vibrant);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .logo p {
            color: var(--primary-blue);
            font-weight: 600;
            font-size: 0.525rem;
        }

        .page {
            background: white;
            border-radius: 9px;
            padding: 9px;
            box-shadow: var(--shadow-xl);
            width: 100%;
            display: none;
            position: relative;
            border: 1px solid rgba(255, 255, 255, 0.2);
            background: linear-gradient(to bottom right, rgba(255, 255, 255, 0.9), rgba(255, 255, 255, 0.7));
            backdrop-filter: blur(10px);
        }

        .active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(6px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .promo-banner {
            background: var(--gradient-vibrant);
            color: white;
            padding: 11.25px;
            border-radius: 7.5px;
            margin-bottom: 11.25px;
            text-align: center;
            font-size: 0.45rem;
            box-shadow: var(--shadow-lg);
            position: relative;
            overflow: hidden;
        }

        .promo-banner::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0) 100%);
            z-index: 1;
        }

        .promo-banner h2 {
            font-size: 0.675rem;
            margin-bottom: 6px;
            color: white;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.2);
            position: relative;
            z-index: 2;
        }

        .promo-banner p {
            line-height: 1.4;
            text-align: justify;
            position: relative;
            z-index: 2;
        }

        .form-group {
            margin-bottom: 6px;
        }

        .form-label {
            display: block;
            margin-bottom: 1.5px;
            font-weight: 600;
            color: var(--dark-blue);
            font-size: 0.525rem;
        }

        .form-input, .form-select {
            width: 100%;
            padding: 4.5px 6.75px;
            border: 1.5px solid var(--light-blue);
            border-radius: 3.75px;
            font-size: 0.525rem;
            background: #f8fafc;
            transition: all 0.2s;
        }

        .form-input:focus, .form-select:focus {
            outline: none;
            border-color: var(--primary-blue);
            box-shadow: 0 0 0 2px rgba(26, 86, 219, 0.15);
        }

        .input-container {
            position: relative;
        }

        .password-container .form-input {
            padding-right: 22.5px;
        }

        .input-icon {
            position: absolute;
            right: 7.5px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--primary-blue);
            font-size: 0.525rem;
            cursor: pointer;
        }

        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 4.5px 7.5px;
            border: none;
            border-radius: 6px;
            font-weight: 700;
            font-size: 0.525rem;
            cursor: pointer;
            transition: all 0.2s;
            text-decoration: none;
            gap: 3px;
            width: 100%;
            box-shadow: var(--shadow);
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: "";
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: left 0.5s;
        }

        .btn:hover::before {
            left: 100%;
        }

        .btn-primary {
            background: var(--gradient-blue);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-1px);
            box-shadow: 0 2px 4px rgba(26, 86, 219, 0.2);
        }

        .btn-contact {
            background: var(--gradient-green);
            color: white;
        }

        .btn-contact:hover {
            transform: translateY(-1px);
            box-shadow: 0 2px 4px rgba(16, 185, 129, 0.2);
        }

        .btn-whatsapp {
            background: linear-gradient(135deg, #25d366, #128c7e);
            color: white;
        }

        .btn-whatsapp:hover {
            transform: translateY(-1px);
            box-shadow: 0 2px 4px rgba(37, 211, 102, 0.2);
        }

        .btn-purple {
            background: var(--gradient-purple);
            color: white;
        }

        .btn-purple:hover {
            transform: translateY(-1px);
            box-shadow: 0 2px 4px rgba(139, 92, 246, 0.2);
        }

        .btn-red {
            background: var(--gradient-red);
            color: white;
        }

        .btn-red:hover {
            transform: translateY(-1px);
            box-shadow: 0 2px 4px rgba(239, 68, 68, 0.2);
        }

        .btn-orange {
            background: var(--gradient-orange);
            color: white;
        }

        .btn-orange:hover {
            transform: translateY(-1px);
            box-shadow: 0 2px 4px rgba(245, 158, 11, 0.2);
        }

        .error-box {
            background: #fee2e2;
            color: var(--accent-red);
            padding: 3.75px 5.25px;
            border-radius: 2.25px;
            margin-top: 4.5px;
            display: none;
            font-weight: 600;
            font-size: 0.525rem;
            border-left: 2.25px solid var(--accent-red);
        }

        .success-box {
            background: #d1fae5;
            color: var(--accent-green);
            padding: 3.75px 5.25px;
            border-radius: 2.25px;
            margin-top: 4.5px;
            display: none;
            font-weight: 600;
            font-size: 0.525rem;
            border-left: 2.25px solid var(--accent-green);
        }

        .notification-box {
            background: #fef3c7;
            color: #d97706;
            padding: 7.5px;
            border-radius: 4.5px;
            margin-top: 7.5px;
            font-weight: 600;
            font-size: 0.525rem;
            text-align: center;
            border-left: 3px solid #f59e0b;
        }

        .quiz-notification {
            position: fixed;
            top: 15px;
            right: 15px;
            background: white;
            padding: 11.25px;
            border-radius: 7.5px;
            box-shadow: var(--shadow-xl);
            z-index: 1000;
            display: none;
            max-width: 225px;
            border-left: 3.75px solid var(--accent-green);
            animation: slideInRight 0.3s ease;
            transform: translateX(100%);
        }

        .quiz-notification.show {
            display: block;
            transform: translateX(0);
        }

        .quiz-notification.warning {
            border-left-color: var(--accent-orange);
        }

        .quiz-notification.error {
            border-left-color: var(--accent-red);
        }

        .quiz-notification-content {
            display: flex;
            flex-direction: column;
            gap: 7.5px;
        }

        .quiz-notification-title {
            font-weight: 700;
            font-size: 0.6rem;
            color: var(--dark-blue);
        }

        .quiz-notification-message {
            font-size: 0.525rem;
            color: #4b5563;
        }

        .quiz-notification-actions {
            display: flex;
            gap: 6px;
            justify-content: flex-end;
        }

        .quiz-notification-btn {
            padding: 3px 6px;
            border-radius: 3px;
            font-size: 0.4875rem;
            font-weight: 600;
            cursor: pointer;
            border: none;
            transition: all 0.2s;
        }

        .quiz-notification-btn.primary {
            background: var(--gradient-blue);
            color: white;
        }

        .quiz-notification-btn.secondary {
            background: #f3f4f6;
            color: #4b5563;
        }

        @keyframes slideInRight {
            from { transform: translateX(100%); }
            to { transform: translateX(0); }
        }

        .main-page-buttons {
            display: grid;
            gap: 6px;
            margin-top: 9px;
        }

        .quiz-access-section {
            display: none;
            flex-direction: column;
            gap: 6px;
            margin-top: 9px;
        }

        .quiz-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 6px;
            padding-bottom: 4.5px;
            border-bottom: 1.5px solid var(--light-blue);
        }

        .quiz-title-container {
            display: flex;
            flex-direction: column;
            gap: 2.25px;
            width: 80%;
        }

        .quiz-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 6px;
            font-size: 0.525rem;
            color: var(--dark-blue);
            font-weight: 600;
        }

        .timer-container {
            display: flex;
            gap: 4.5px;
            justify-content: flex-end;
            width: 100%;
        }

        .timer, .question-timer {
            background: var(--gradient-blue);
            color: white;
            padding: 2.25px 4.5px;
            border-radius: 7.5px;
            font-weight: 700;
            font-size: 0.525rem;
            box-shadow: var(--shadow);
            white-space: nowrap;
        }

        .timer.total-timer {
            background: var(--gradient-orange);
        }

        .progress-container {
            width: 100%;
            height: 4.5px;
            background: #e5e7eb;
            border-radius: 2.25px;
            overflow: hidden;
            margin-bottom: 6px;
            box-shadow: var(--shadow);
        }

        .progress-bar {
            height: 100%;
            border-radius: 2.25px;
            transition: width 0.4s ease;
            background: var(--gradient-vibrant);
        }

        .question-nav {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(10.5px, 1fr));
            gap: 2.25px;
            margin-bottom: 6px;
        }

        .question-nav-item {
            width: 10.5px;
            height: 10.5px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 2.25px;
            font-weight: 700;
            font-size: 0.375rem;
            cursor: pointer;
            background: white;
            border: 1.5px solid var(--light-blue);
            transition: all 0.2s;
        }

        .question-nav-item.current {
            background: var(--gradient-vibrant);
            color: white;
            border-color: var(--primary-blue);
            transform: scale(1.1);
        }

        .question-nav-item.solved {
            background: var(--gradient-green);
            color: white;
            border-color: var(--accent-green);
        }

        .question-nav-item.visited {
            background: var(--gradient-orange);
            color: white;
            border-color: var(--accent-orange);
        }

        .question-container {
            margin-bottom: 6px;
        }

        .question-text {
            font-size: 0.5625rem;
            font-weight: 700;
            margin-bottom: 4.5px;
            color: var(--dark-blue);
        }

        .options-container {
            display: grid;
            grid-template-columns: 1fr;
            gap: 3px;
            margin-bottom: 6px;
        }

        .option {
            padding: 3.75px 6px;
            border: 1.5px solid var(--light-blue);
            border-radius: 3.75px;
            cursor: pointer;
            transition: all 0.2s;
            font-weight: 500;
            background: #f8fafc;
            font-size: 0.525rem;
            position: relative;
        }

        .option:hover {
            border-color: var(--primary-blue);
            background: #e0f2fe;
            transform: translateY(-1px);
        }

        .option.selected {
            border-color: var(--primary-blue);
            background: #dbeafe;
        }

        .option.correct {
            border-color: var(--accent-green);
            background: #d1fae5;
        }

        .option.incorrect {
            border-color: var(--accent-red);
            background: #fee2e2;
        }

        .option input[type="radio"] {
            position: absolute;
            opacity: 0;
            cursor: pointer;
        }

        .reasoning {
            background: #f8fafc;
            border-radius: 3.75px;
            padding: 6px;
            margin-top: 6px;
            display: none;
            border-left: 2.25px solid var(--primary-blue);
            font-size: 0.525rem;
        }

        .reasoning-title {
            font-weight: 700;
            margin-bottom: 3px;
            color: var(--dark-blue);
            font-size: 0.5625rem;
        }

        .navigation-buttons {
            display: flex;
            flex-direction: column;
            gap: 3px;
            margin-top: 9px;
        }

        .nav-btn {
            padding: 3.75px 5.25px;
            border-radius: 3.75px;
            font-weight: 600;
            cursor: pointer;
            border: none;
            transition: all 0.2s;
            font-size: 0.525rem;
            display: flex;
            align-items: center;
            gap: 2.25px;
            justify-content: center;
            width: 100%;
        }

        .btn-back {
            background: linear-gradient(135deg, #3b82f6, #60a5fa);
            color: white;
        }

        .btn-next {
            background: linear-gradient(135deg, #1d4ed8, #3b82f6);
            color: white;
        }

        .btn-reasoning {
            background: var(--gradient-purple);
            color: white;
        }

        .btn-reasoning.disabled {
            background: #dc3545;
            color: white;
            cursor: not-allowed;
            opacity: 0.6;
        }

        .btn-reasoning.disabled:hover {
            background: #dc3545;
            transform: none;
            box-shadow: none;
        }

        .btn-submit {
            background: var(--gradient-green);
            color: white;
        }

        .results-header-buttons {
            display: flex;
            flex-direction: column;
            gap: 3.75px;
            margin-bottom: 9px;
        }

        .results-header-buttons .btn {
            padding: 3px 4.5px;
            font-size: 0.4875rem;
            width: 100%;
        }

        .result-card {
            background: linear-gradient(135deg, #f8fafc, #e0f2fe);
            border-radius: 6px;
            padding: 9px;
            text-align: center;
            margin-bottom: 9px;
            box-shadow: var(--shadow);
            position: relative;
            z-index: 1;
            overflow: hidden;
        }

        .result-card::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: var(--gradient-vibrant);
        }

        .result-card h2 {
            font-size: 0.675rem;
            margin-bottom: 6px;
            color: var(--dark-blue);
        }

        .result-card table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.525rem;
            margin-top: 6px;
            box-shadow: var(--shadow);
        }

        .result-card th, .result-card td {
            padding: 3.75px;
            border: 1px solid #dbeafe;
            text-align: left;
        }

        .result-card th {
            background-color: var(--light-blue);
            font-weight: 600;
        }

        .result-card td {
            background-color: #f8fafc;
        }

        .result-actions {
            display: flex;
            flex-direction: column;
            gap: 4.5px;
            margin-top: 9px;
        }

        .all-mcqs-list {
            display: flex;
            flex-direction: column;
            gap: 11.25px;
        }

        .all-mcq-item {
            padding: 7.5px;
            border: 1px solid var(--light-blue);
            border-radius: 6px;
            background: #f8fafc;
            position: relative;
        }

        .all-mcq-item .question-text {
            color: var(--dark-blue);
            font-size: 0.6rem;
            font-weight: 700;
        }

        .all-mcq-options {
            display: flex;
            flex-direction: column;
            gap: 3px;
            margin-top: 4.5px;
        }

        .all-mcq-option {
            font-size: 0.525rem;
            padding: 3px 4.5px;
            border-radius: 3px;
            border: 1px solid #e5e7eb;
        }

        .all-mcq-option.correct {
            background: #d1fae5;
            color: var(--accent-green);
            font-weight: 600;
            border-color: #a7f3d0;
        }

        .all-mcq-reasoning {
            margin-top: 6px;
            font-size: 0.525rem;
            color: #4b5563;
            padding: 6px;
            background: #f8fafc;
            border-radius: 3px;
            border-left: 2.25px solid var(--primary-blue);
        }

        .all-mcq-reasoning strong {
            color: var(--dark-blue);
        }

        .quick-stats {
            display: flex;
            justify-content: space-between;
            margin-bottom: 9px;
            gap: 6px;
        }

        .stat-card {
            flex: 1;
            background: white;
            border-radius: 4.5px;
            padding: 6px;
            text-align: center;
            box-shadow: var(--shadow);
            border-top: 2px solid var(--primary-blue);
        }

        .stat-card.correct {
            border-top-color: var(--accent-green);
        }

        .stat-card.incorrect {
            border-top-color: var(--accent-red);
        }

        .stat-card.unanswered {
            border-top-color: var(--accent-orange);
        }

        .stat-value {
            font-size: 0.9rem;
            font-weight: 800;
            margin-bottom: 1.5px;
        }

        .stat-label {
            font-size: 0.4875rem;
            font-weight: 600;
            color: #6b7280;
        }

        .performance-meter {
            width: 100%;
            height: 6px;
            background: #e5e7eb;
            border-radius: 3px;
            overflow: hidden;
            margin: 6px 0;
        }

        .performance-fill {
            height: 100%;
            border-radius: 3px;
            transition: width 0.4s ease;
            background: var(--gradient-vibrant);
        }

        @media (max-width: 768px) {
            .quiz-header {
                flex-direction: column;
                gap: 4.5px;
                align-items: flex-start;
            }
            
            .navigation-buttons {
                grid-template-columns: 1fr;
            }
            
            .timer-container {
                position: relative;
                top: auto;
                right: auto;
                margin-top: 3.75px;
                justify-content: flex-end;
                width: 100%;
            }
            
            .quiz-title-container {
                width: 100%;
            }
            
            .result-actions {
                flex-direction: column;
            }
            
            .promo-banner {
                padding: 9px;
            }
            
            .promo-banner h2 {
                font-size: 0.6rem;
            }
            
            .promo-banner p {
                font-size: 0.4125rem;
            }
        }
    </style>
</head>
<body>
    <div class="quiz-notification" id="quiz-notification">
        <div class="quiz-notification-content">
            <div class="quiz-notification-title" id="notification-title">Quiz Progress Found</div>
            <div class="quiz-notification-message" id="notification-message">You have an unfinished quiz. Do you want to continue where you left off?</div>
            <div class="quiz-notification-actions">
                <button class="quiz-notification-btn secondary" id="notification-no">Start Fresh</button>
                <button class="quiz-notification-btn primary" id="notification-yes">Continue</button>
            </div>
        </div>
    </div>

    <div class="container">
        <div class="logo">
            <h1>WHITE COAT WARRIORS</h1>
            <p>Excellence in Educational Assessment</p>
        </div>

        <div id="signin-page" class="page active">
            <div class="promo-banner">
                <h2><i class="fas fa-graduation-cap"></i> Unlock Your Potential with WHITE COAT WARRIORS</h2>
                <p>Boost your preparation with WHITE COAT WARRIORS's realistic online tests, crafted by experts to mirror the actual exam's pattern and challenge. Experience instant feedback, detailed analysis, and flexible online access – your pathway to confidence and success!</p>
            </div>
            
            <h2><i class="fas fa-lock"></i> Access Test</h2>
            <p>Sign in or use your access code</p>
            
            <div class="main-page-buttons">
                <button class="btn btn-primary" onclick="showQuizAccessForm()">
                    <i class="fas fa-key"></i>
                    <span>Sign In with Quiz Access Code</span>
                </button>
                <button class="btn btn-primary" onclick="showRegistrationPage()">
                    <i class="fas fa-user-plus"></i>
                    <span>Sign Up to Get Quiz Access</span>
                </button>
                <button class="btn btn-purple" onclick="showDeveloperAccessForm()">
                    <i class="fas fa-code"></i>
                    <span>Developer Access</span>
                </button>
            </div>
            
            <div id="developer-access-form" class="quiz-access-section">
                <h3><i class="fas fa-user-secret"></i> Developer Login</h3>
                <div class="password-container input-container">
                    <input type="password" id="developerPassword" class="form-input" placeholder="Enter the Developer Password">
                    <i class="fas fa-eye-slash input-icon" id="toggleDeveloperPassword"></i>
                </div>
                <button class="btn btn-purple" onclick="checkDeveloperPassword()">
                    <span>Log In</span>
                    <i class="fas fa-arrow-right"></i>
                </button>
                <div id="dev-error-box" class="error-box">
                    <i class="fas fa-exclamation-circle"></i> Invalid developer password.
                </div>
            </div>
            
            <div id="quiz-access-form" class="quiz-access-section">
                <h3><i class="fas fa-key"></i> Enter Quiz Access Code</h3>
                <div class="password-container input-container">
                    <input type="password" id="quizAccessCode" class="form-input" placeholder="Enter your 12-Digit Quiz Access Code here">
                    <i class="fas fa-eye-slash input-icon" id="toggleQuizAccessCode"></i>
                </div>
                <button class="btn btn-primary" onclick="accessQuiz(document.getElementById('quizAccessCode').value)">
                    <span>Access Quiz</span>
                    <i class="fas fa-arrow-right"></i>
                </button>
                <div id="quiz-error-box" class="error-box">
                    <i class="fas fa-exclamation-circle"></i> Invalid quiz access code.
                </div>
            </div>
            
        </div>

        <div id="registration-page" class="page">
            <div class="promo-banner">
                <h2><i class="fas fa-graduation-cap"></i> Unlock Your Potential with WHITE COAT WARRIORS</h2>
                <p>Boost your preparation with WHITE COAT WARRIORS's realistic online tests, crafted by experts to mirror the actual exam's pattern and challenge. Experience instant feedback, detailed analysis, and flexible online access – your pathway to confidence and success!</p>
            </div>
            
            <h2><i class="fas fa-user-edit"></i> Student Registration</h2>
            <p>Please provide your details to register</p>
            
            <div class="form-group">
                <label class="form-label"><i class="fas fa-user"></i> Student Name</label>
                <input type="text" id="studentName" class="form-input" placeholder="Enter your full name">
            </div>
            <div class="form-group">
                <label class="form-label"><i class="fas fa-user-friends"></i> Father Name</label>
                <input type="text" id="fatherName" class="form-input" placeholder="Enter your father's name">
            </div>
            <div class="form-group">
                <label class="form-label"><i class="fas fa-envelope"></i> Email Address</label>
                <input type="email" id="email" class="form-input" placeholder="Enter your email address">
            </div>
            <div class="form-group">
                <label class="form-label"><i class="fas fa-phone"></i> Mobile Number (WhatsApp)</label>
                <input type="tel" id="mobile" class="form-input" placeholder="+92XXXXXXXXXX">
            </div>
            <div class="form-group">
                <label class="form-label"><i class="fas fa-city"></i> City / District</label>
                <input type="text" id="city" class="form-input" placeholder="Enter your city/district">
            </div>
            <button class="btn btn-primary" onclick="handleRegistration()">
                <span>Submit to Get Access to Quiz</span>
                <i class="fas fa-arrow-right"></i>
            </button>
            <button class="btn btn-red" style="margin-top: 3.75px;" onclick="showPage('signin-page')">
                <i class="fas fa-chevron-left"></i> Back to Home
            </button>
        </div>

        <div id="quiz-page" class="page">
            <div class="promo-banner">
                <h2><i class="fas fa-graduation-cap"></i> Unlock Your Potential with WHITE COAT WARRIORS</h2>
                <p>Boost your preparation with WHITE COAT WARRIORS's realistic online tests, crafted by experts to mirror the actual exam's pattern and challenge. Experience instant feedback, detailed analysis, and flexible online access – your pathway to confidence and success!</p>
            </div>

            <div class="quiz-header">
                <div class="quiz-title-container">
                    <h2 id="quiz-title"></h2>
                    <div class="quiz-info">
                        <span><i class="fas fa-book"></i> Subject: <span id="quiz-subject">English Grammar</span></span>
                        <span><i class="fas fa-clock"></i> Per MCQ: <span id="per-mcq-time">1</span> Minute</span>
                    </div>
                </div>
            </div>
            <div class="timer-container">
                <div class="timer" id="question-timer">60</div>
                <div class="timer total-timer" id="timer">40:00</div>
            </div>

            <div class="progress-container">
                <div class="progress-bar" id="quiz-progress"></div>
            </div>

            <div class="question-nav" id="question-nav"></div>
            
            <div class="question-container">
                <div class="question-text" id="question-text"></div>
                <div class="options-container" id="options-container"></div>
                <div class="reasoning" id="reasoning">
                    <div class="reasoning-title"><i class="fas fa-lightbulb"></i> Explanation:</div>
                    <div id="reasoning-text"></div>
                </div>
            </div>
            
            <div class="navigation-buttons">
                <button class="nav-btn btn-back" onclick="navigateQuestion('prev')">
                    <i class="fas fa-arrow-left"></i> Back
                </button>
                <button class="nav-btn btn-next" onclick="navigateQuestion('next')">
                    Next <i class="fas fa-arrow-right"></i>
                </button>
                <button class="nav-btn btn-reasoning disabled" id="reasoning-btn" onclick="toggleReasoning()">
                    <i class="fas fa-lightbulb"></i> Reasoning
                </button>
                <button class="nav-btn btn-submit" onclick="submitTest()">
                    Submit <i class="fas fa-paper-plane"></i>
                </button>
            </div>
        </div>

        <div id="results-page" class="page">
            <div class="results-header-buttons">
                <a id="website-link" href="#" target="_blank" class="btn btn-primary"><i class="fas fa-globe"></i> Website</a>
                <a id="whatsapp-contact-link" href="#" target="_blank" class="btn btn-whatsapp"><i class="fab fa-whatsapp"></i> Whatsapp Contact</a>
                <a id="whatsapp-community-link" href="#" target="_blank" class="btn btn-whatsapp"><i class="fas fa-users"></i> Whatsapp Community</a>
            </div>
            
            <div class="quick-stats">
                <div class="stat-card correct">
                    <div class="stat-value" id="correct-count">0</div>
                    <div class="stat-label">Correct</div>
                </div>
                <div class="stat-card incorrect">
                    <div class="stat-value" id="incorrect-count">0</div>
                    <div class="stat-label">Incorrect</div>
                </div>
                <div class="stat-card unanswered">
                    <div class="stat-value" id="unanswered-count">0</div>
                    <div class="stat-label">Unanswered</div>
                </div>
            </div>
            
            <div class="performance-meter">
                <div class="performance-fill" id="performance-fill"></div>
            </div>
            
            <div class="result-card">
                <h2><i class="fas fa-user-graduate"></i> Student Information</h2>
                <table>
                    <thead>
                        <tr>
                            <th>Field</th>
                            <th>Detail</th>
                        </tr>
                    </thead>
                    <tbody id="student-info-table"></tbody>
                </table>
            </div>

            <div class="result-card">
                <h2><i class="fas fa-chart-bar"></i> Test Results</h2>
                <table>
                    <tbody id="quiz-results-table"></tbody>
                </table>
            </div>
            
            <div class="result-actions">
                <button class="btn btn-primary" onclick="restartTest()">
                    <i class="fas fa-redo"></i> Retake Full Test
                </button>
                <button class="btn btn-primary" onclick="retakeIncorrect()">
                    <i class="fas fa-bolt"></i> Retake Incorrect Questions
                </button>
                <button class="btn btn-primary" onclick="viewAllMcqs()">
                    <i class="fas fa-clipboard-list"></i> View All MCQs
                </button>
            </div>
        </div>

        <div id="all-mcqs-page" class="page">
            <h2><i class="fas fa-list-alt"></i> All MCQs and Solutions</h2>
            <div class="all-mcqs-list" id="all-mcqs-list"></div>
            <button class="btn btn-primary" onclick="showPage('results-page')">
                <i class="fas fa-arrow-left"></i> Back to Results
            </button>
        </div>
    </div>
    
    <script src="script.js"></script>
</body>
</html><script>// ***************************************************************
// !! IMPORTANT: GOOGLE APPS SCRIPT URL FOR DATA LOGGING !!
const SHEET_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbxH08_vQhw7nqJCy3igwm70zXI2Mwau8CvcIeXdZMF2dFm9bPfgWtP6En4GQZGKte7c/exec';
// ***************************************************************

// Quiz Data
const quizData_WCW_BIO_04 = [
    {
        question: "The science that focuses on the study of how characteristics are passed from parents to offspring, alongside the variations observed, is fundamentally defined as:",
        options: [
            "Cytology",
            "Ecology",
            "Genetics",
            "Physiology"
        ],
        correctAnswer: 2,
        reasoning: "The Book theory State that Genetics is defined as the science dealing with heredity and variation, controlling hereditary characteristics."
    },
    {
        question: "Gregor Mendel's significant work, laying the foundation for modern heredity theory, was primarily conducted using which specific organism?",
        options: [
            "Fruit flies (Drosophila melanogaster)",
            "Garden peas (Pisum sativum)",
            "Baker's yeast (Saccharomyces cerevisiae)",
            "Corn plants (Zea mays)"
        ],
        correctAnswer: 1,
        reasoning: "The Book theory State that Gregor Mendel conducted his foundational work on pea plants (Pisum sativum)."
    },
    {
        question: "A key reason for Mendel's success with pea plants was their characteristic of possessing distinct contrasting heritable characters. How many such pairs did he primarily study?",
        options: [
            "Three",
            "Five",
            "Seven",
            "Nine"
        ],
        correctAnswer: 2,
        reasoning: "The Book theory State that one of the reasons for Mendel's success was that pea plants possess distinct contrasting heritable characters, specifically seven pairs."
    },
    {
        question: "What term refers to the specific physical location of a gene on a chromosome?",
        options: [
            "Allele",
            "Locus",
            "Genotype",
            "Phenotype"
        ],
        correctAnswer: 1,
        reasoning: "The Book theory State that the locus is defined as the specific position of a gene on a chromosome."
    },
    {
        question: "Which of the following correctly defines alleles in the context of Mendelian genetics?",
        options: [
            "The observable form of a trait",
            "The genetic complement of an individual",
            "Alternative forms of a gene pair occupying the same locus",
            "A gene that is always expressed in the F1 generation"
        ],
        correctAnswer: 2,
        reasoning: "The Book theory State that alleles are alternative forms of a gene pair, occupying the same locus on homologous chromosomes."
    },
    {
        question: "In genetic terminology, an individual possessing two identical alleles for a particular gene is described as:",
        options: [
            "Heterozygous",
            "Hemizygous",
            "Homozygous",
            "Dominant"
        ],
        correctAnswer: 2,
        reasoning: "The Book theory State that homozygous describes having two identical alleles for a gene."
    },
    {
        question: "The observable form or appearance of a trait, such as 'round seeds' or 'red eyes', is known as the:",
        options: [
            "Genotype",
            "Allele",
            "Locus",
            "Phenotype"
        ],
        correctAnswer: 3,
        reasoning: "The Book theory State that phenotype is the observable form or appearance of a trait."
    },
    {
        question: "When studying the inheritance of a single trait, such as seed shape in peas, the type of genetic cross performed is termed a:",
        options: [
            "Dihybrid cross",
            "Test cross",
            "Monohybrid cross",
            "Reciprocal cross"
        ],
        correctAnswer: 2,
        reasoning: "The Book theory State that a monohybrid cross is the study of inheritance of a single trait."
    },
    {
        question: "According to the Law of Dominance, which allele's expression is masked in the F1 generation of a monohybrid cross?",
        options: [
            "The dominant allele",
            "The recessive allele",
            "Both alleles are expressed equally",
            "Neither allele is expressed"
        ],
        correctAnswer: 1,
        reasoning: "The Book theory State that the recessive trait/allele is masked in F1 and reappears in F2, consistent with the Law of Dominance where one factor dominates the other."
    },
    {
        question: "What is the expected phenotypic ratio in the F2 generation resulting from a monohybrid cross, assuming complete dominance?",
        options: [
            "1:2:1",
            "9:3:3:1",
            "3:1",
            "1:1"
        ],
        correctAnswer: 2,
        reasoning: "The Book theory State that the F2 generation of a monohybrid cross exhibits a phenotypic ratio of 3:1 (dominant:recessive)."
    },
    {
        question: "The Law of Segregation is also known by what alternative name, emphasizing the genetic content of reproductive cells?",
        options: [
            "Law of Independent Assortment",
            "Law of Purity of Gametes",
            "Law of Dominance",
            "Law of Recombination"
        ],
        correctAnswer: 1,
        reasoning: "The Book theory State that the Law of Segregation is also known as the Purity of Gametes, as it describes how alleles separate into gametes."
    },
    {
        question: "Which type of cross is specifically designed to determine if an individual displaying a dominant phenotype is homozygous dominant or heterozygous?",
        options: [
            "Monohybrid cross",
            "Dihybrid cross",
            "Test cross",
            "Reciprocal cross"
        ],
        correctAnswer: 2,
        reasoning: "The Book theory State that a Test Cross is a mating between an individual with a dominant phenotype (unknown genotype) and an individual showing the recessive phenotype to determine the dominant individual's genotype."
    },
    {
        question: "Thomas Hunt Morgan pioneered the study of sex linkage using which model organism?",
        options: [
            "Garden peas",
            "Bacteria",
            "Fruit flies",
            "Humans"
        ],
        correctAnswer: 2,
        reasoning: "The Book theory State that Thomas Hunt Morgan studied Drosophila melanogaster (fruit flies) and provided experimental evidence for sex linkage."
    },
    {
        question: "One of the advantages of using *Drosophila melanogaster* in genetic studies, as highlighted in the provided text, is their short generation time. Approximately how long is this cycle?",
        options: [
            "1 week",
            "2 weeks",
            "1 month",
            "3 months"
        ],
        correctAnswer: 1,
        reasoning: "The Book theory State that *Drosophila* has a short generation time of 2 weeks."
    },
    {
        question: "In Morgan's *Drosophila* eye color experiments, which eye color was identified as the recessive mutant trait?",
        options: [
            "Bright red",
            "White",
            "Brown",
            "Purple"
        ],
        correctAnswer: 1,
        reasoning: "The Book theory State that Morgan's *Drosophila* eye color experiments identified white eyes as the recessive mutant trait."
    },
    {
        question: "What term describes traits controlled by alleles located on the X or Y chromosomes?",
        options: [
            "Autosomal traits",
            "Linked traits",
            "Sex-linked traits",
            "Polygenic traits"
        ],
        correctAnswer: 2,
        reasoning: "The Book theory State that Sex Linkage refers to traits controlled by alleles on sex chromosomes (X or Y)."
    },
    {
        question: "Which of the following is a characteristic of X-linked recessive inheritance in humans?",
        options: [
            "Affected fathers transmit the trait to all sons.",
            "Affected mothers transmit the trait to all daughters.",
            "Males are affected more frequently than females.",
            "Females are never carriers, only affected or unaffected."
        ],
        correctAnswer: 2,
        reasoning: "The Book theory State that in X-linked recessive inheritance, males are affected more than women because they are hemizygous for the X chromosome."
    },
    {
        question: "Haemophilia A is explicitly characterized by an abnormality or deficiency of which specific clotting factor?",
        options: [
            "Factor I",
            "Factor VIII",
            "Factor IX",
            "Factor XI"
        ],
        correctAnswer: 1,
        reasoning: "The Book theory State that Haemophilia A is caused by abnormality/deficiency of clotting factor VIII."
    },
    {
        question: "The final step in the blood clotting mechanism involves the conversion of a soluble protein, fibrinogen, into insoluble strands. What are these strands called?",
        options: [
            "Thrombin",
            "Prothrombin",
            "Fibrin",
            "Platelets"
        ],
        correctAnswer: 2,
        reasoning: "The Book theory State that the final step involves converting Factor I (fibrinogen, a soluble protein) into thin strands of solid protein called fibrin."
    },
    {
        question: "What is the primary role of platelets in the initial response to a cut blood vessel?",
        options: [
            "To release clotting factor VIII",
            "To convert fibrinogen into fibrin",
            "To become sticky and clump around the cut",
            "To initiate the cascade of clotting factors"
        ],
        correctAnswer: 2,
        reasoning: "The Book theory State that cutting a blood vessel causes damaged tissue to make platelets 'sticky,' leading to clumping around the cut."
    },
    {
        question: "Gregor Mendel's groundbreaking work, published in 1866, remained largely unrecognized for an extended period. The primary reason for this early neglect was primarily due to biologists' preoccupation with which contemporary scientific theory?",
        options: [
            "The theory of spontaneous generation",
            "Darwin's theory of evolution by natural selection",
            "Lamarck's theory of inheritance of acquired characteristics",
            "The cell theory"
        ],
        correctAnswer: 1,
        reasoning: "The Book theory State that Mendel's work remained unrecognized for 34 years due to biologists' preoccupation with Darwin's theory (1859), along with a lack of familiarity with statistical analysis."
    },
    {
        question: "Factors, also known as genes or alleles, are defined as hereditary information transmitted from parents to offspring. The concept states that each specific trait is fundamentally determined by a pair of these factors, with one originating from each parent. This foundational idea directly underpins which aspect of Mendelian inheritance?",
        options: [
            "The phenotypic expression of dominant alleles",
            "The mechanism of gene linkage",
            "The biparental inheritance of genetic traits",
            "The independent assortment of unlinked genes"
        ],
        correctAnswer: 2,
        reasoning: "The Book theory State that hereditary information is transmitted from parents to offspring, with each trait determined by a pair of factors (alleles), one from each parent. This describes biparental inheritance."
    },
    {
        question: "Alleles, characterized as alternative forms of a gene pair, occupy the identical locus on homologous chromosomes. They possess the capacity to be either identical in form or distinctly different. This description directly distinguishes between which two fundamental genetic states?",
        options: [
            "Dominant and recessive traits",
            "Monohybrid and dihybrid crosses",
            "Homozygous and heterozygous conditions",
            "Phenotype and genotype"
        ],
        correctAnswer: 2,
        reasoning: "The Book theory State that alleles can be identical (homozygous) or different (heterozygous), directly describing the distinction between these two genetic states."
    },
    {
        question: "A dominant trait or allele is explicitly described as one that is expressed in the F1 generation of a monohybrid cross. Conversely, a recessive trait or allele is described as being masked in the F1 generation, only reappearing in the F2. This selective expression is directly observed in accordance with which of Mendel's laws?",
        options: [
            "The Law of Segregation",
            "The Law of Independent Assortment",
            "The Law of Dominance",
            "The principle of purity of gametes"
        ],
        correctAnswer: 2,
        reasoning: "The Book theory State that the Law of Dominance explains that in a pair of contrasting traits, one factor (allele) dominates the other, leading to the expression of the dominant trait in F1 and the masking of the recessive."
    },
    {
        question: "In a monohybrid cross, the P1 generation consists of true-breeding parents. The F1 generation, produced from this cross, consistently exhibits the dominant phenotype and is uniformly heterozygous. The self-fertilization of this F1 generation leads to an F2 generation with a specific genotypic ratio. What is this genotypic ratio?",
        options: [
            "3:1 (dominant:recessive)",
            "1:1 (homozygous dominant:heterozygous)",
            "1:2:1 (homozygous dominant:heterozygous:homozygous recessive)",
            "9:3:3:1 (various phenotypes)"
        ],
        correctAnswer: 2,
        reasoning: "The Book theory State that the F2 generation resulting from the self-fertilization of F1 heterozygotes in a monohybrid cross shows a genotypic ratio of 1:2:1 (homozygous dominant:heterozygous:homozygous recessive)."
    },
    {
        question: "The Law of Segregation asserts that the two coexisting alleles for each trait within an individual separate from each other during meiosis. This fundamental process ensures that each gamete ultimately receives only one of the two alleles. This segregation is critical for the maintenance of genetic variation and specifically for which subsequent event?",
        options: [
            "Maintaining homozygosity across generations",
            "Ensuring that offspring are always heterozygous",
            "The random uniting of alleles at fertilization",
            "Preventing mutations in gametes"
        ],
        correctAnswer: 2,
        reasoning: "The Book theory State that the two coexisting alleles for each trait segregate from each other during meiosis, so each gamete receives only one of the two alleles, and these alleles then unite randomly at fertilization."
    },
    {
        question: "A test cross involves mating an individual with a dominant phenotype but an unknown genotype (e.g., R_) with an individual exhibiting the recessive phenotype (rr). If all offspring from such a cross display the dominant phenotype, what can be definitively concluded about the genotype of the dominant parent?",
        options: [
            "It is heterozygous (Rr).",
            "It is homozygous dominant (RR).",
            "It is homozygous recessive (rr).",
            "Its genotype cannot be determined from this single cross."
        ],
        correctAnswer: 1,
        reasoning: "The Book theory State that if a dominant individual in a test cross is homozygous dominant (RR), all offspring will be dominant (Rr)."
    },
    {
        question: "In a dihybrid cross, true-breeding parents differing in two traits (e.g., RRYY x rryy) produce an F1 generation where all offspring show dominant phenotypes for both traits and are heterozygous (e.g., RrYy). When this F1 generation is self-fertilized, what is the expected phenotypic ratio in the F2 generation?",
        options: [
            "1:2:1",
            "3:1",
            "1:1:1:1",
            "9:3:3:1"
        ],
        correctAnswer: 3,
        reasoning: "The Book theory State that the F2 generation of a dihybrid cross resulting from self-fertilization of F1 heterozygotes yields a phenotypic ratio of 9:3:3:1."
    },
    {
        question: "The Law of Independent Assortment stipulates that alleles of different gene pairs assort independently of each other during gamete formation. This phenomenon is primarily attributed to the fact that these genes are either situated on different homologous chromosomes or are positioned significantly far apart on the same chromosome. This law is critical for explaining the appearance of what in the F2 generation of a dihybrid cross?",
        options: [
            "An increased frequency of parental phenotypes",
            "New 'recombinant' phenotypes not seen in parents",
            "A reduction in genetic variation",
            "The dominance of one trait over another"
        ],
        correctAnswer: 1,
        reasoning: "The Book theory State that a dihybrid cross's F2 generation produces new 'recombinant' phenotypes not seen in parents, which is a direct consequence of independent assortment."
    },
    {
        question: "R.C. Punnett devised a diagrammatic tool for predicting the outcomes of genetic crosses. This tool systematically organizes parental gametes and potential offspring genotypes. What is this widely used diagram called?",
        options: [
            "Pedigree chart",
            "Karyotype",
            "Punnett Square",
            "Linkage map"
        ],
        correctAnswer: 2,
        reasoning: "The Book theory State that the Punnett Square is a diagrammatic tool devised by R.C. Punnett to predict the outcomes of genetic crosses."
    },
    {
        question: "The 'product rule' in probability, when applied to genetics, states that the joint probability of two independent events occurring simultaneously is derived by what mathematical operation involving their individual probabilities?",
        options: [
            "Summing their individual probabilities",
            "Dividing one probability by the other",
            "Multiplying their individual probabilities",
            "Subtracting the smaller from the larger probability"
        ],
        correctAnswer: 2,
        reasoning: "The Book theory State that the 'product rule' states that the joint probability of two independent events occurring simultaneously is the product of their individual probabilities."
    },
    {
        question: "Thomas Hunt Morgan, renowned for his work on *Drosophila*, provided crucial experimental evidence for the chromosomal theory of heredity and sex linkage. For his scientific contributions, he was awarded the Nobel Prize in which year?",
        options: [
            "1910",
            "1933",
            "1900",
            "1866"
        ],
        correctAnswer: 1,
        reasoning: "The Book theory State that Thomas Hunt Morgan was awarded the Nobel Prize in 1933 for his work on *Drosophila*."
    },
    {
        question: "A distinct advantage of *Drosophila* as a model organism for genetic studies is their small number of chromosomes. How many homologous pairs of chromosomes do they possess?",
        options: [
            "2",
            "4",
            "6",
            "8"
        ],
        correctAnswer: 1,
        reasoning: "The Book theory State that *Drosophila* have a small number of chromosomes (8, in 4 homologous pairs)."
    },
    {
        question: "In Morgan's *Drosophila* eye color experiments, when a white-eyed male was crossed with a red-eyed female, all F1 offspring exhibited red eyes. Subsequently, in the F2 generation, a 3:1 ratio of red:white eyes was observed, but with a critical specific observation regarding the white-eyed individuals. What was this observation?",
        options: [
            "All white-eyed flies were female.",
            "All white-eyed flies were male.",
            "White-eyed flies were equally distributed between males and females.",
            "No white-eyed flies appeared in the F2 generation."
        ],
        correctAnswer: 1,
        reasoning: "The Book theory State that in Morgan's experiment, in F2, a 3:1 ratio of red:white eyes was observed, but all white-eyed flies were male."
    },
    {
        question: "The conclusion drawn from Morgan's *Drosophila* eye color experiments was that the gene for eye color is located on the X chromosome, lacking a counterpart on the Y chromosome. Consequently, males are described as hemizygous for this trait. What does 'hemizygous' imply for males regarding their X chromosome allele?",
        options: [
            "They carry two copies of the allele.",
            "They express a single allele on their X chromosome.",
            "They are always homozygous for the trait.",
            "They only express the dominant allele."
        ],
        correctAnswer: 1,
        reasoning: "The Book theory State that males are hemizygous (XY), expressing a single allele on their X chromosome because there is no counterpart on the Y."
    },
    {
        question: "X-linked inheritance frequently follows a 'crisscross inheritance' pattern. This pattern describes the transmission of an X-linked trait from a maternal grandfather to his daughter, who then acts as a carrier, and subsequently to whom?",
        options: [
            "Her daughter",
            "His son",
            "Her son (the grandson)",
            "His granddaughter"
        ],
        correctAnswer: 2,
        reasoning: "The Book theory State that Crisscross Inheritance means an X-linked trait passes from a maternal grandfather to his daughter (carrier) and then to her son (grandson)."
    },
    {
        question: "A defining characteristic of X-linked recessive inheritance is the observation that there is no direct father-to-son transmission of the trait. What is the genetic basis for this lack of transmission?",
        options: [
            "Sons inherit their X chromosome from their father.",
            "Sons inherit their Y chromosome from their father, not their X.",
            "Fathers cannot be affected by X-linked recessive traits.",
            "Mothers are always the sole source of X-linked traits for sons."
        ],
        correctAnswer: 1,
        reasoning: "The Book theory State that there is no father-to-son transmission because a son inherits his Y chromosome from his father, not his X."
    },
    {
        question: "In the context of X-linked recessive inheritance, females are typically described as carriers if they are heterozygous. These carrier females generally do not exhibit symptoms. Under what rare specific condition can a female be affected by an X-linked recessive disorder?",
        options: [
            "If she is hemizygous for the allele.",
            "If she is homozygous recessive for the allele.",
            "If her father is affected, regardless of her mother's genotype.",
            "If she inherits the dominant allele from one parent."
        ],
        correctAnswer: 1,
        reasoning: "The Book theory State that females can only be affected if homozygous recessive (very rare) in X-linked recessive inheritance."
    },
    {
        question: "Haemophilia A and B are both classic examples of X-linked recessive disorders. Given this inheritance pattern, which statement accurately describes the relative prevalence of these conditions between males and females?",
        options: [
            "Females are affected more than males.",
            "Males and females are affected equally.",
            "Males are affected more than females because they are hemizygous for the X chromosome.",
            "The prevalence depends on environmental factors, not sex."
        ],
        correctAnswer: 2,
        reasoning: "The Book theory State that in X-linked recessive Haemophilia A & B, males are affected more than women because they are hemizygous for the X chromosome."
    },
    {
        question: "Haemophilia C, distinct from types A and B, is caused by a reduction or deficiency of clotting factor XI. Crucially, its inheritance pattern differs from the other types. How is Haemophilia C inherited?",
        options: [
            "X-linked recessive",
            "X-linked dominant",
            "Autosomal recessive",
            "Autosomal dominant"
        ],
        correctAnswer: 2,
        reasoning: "The Book theory State that Haemophilia C is inherited as autosomal recessive."
    },
    {
        question: "Gene linkage refers to the phenomenon where genes located on the same chromosome tend to be inherited together. All linked genes on a homologous pair of chromosomes collectively form what is known as a:",
        options: [
            "Genomic island",
            "Recombination hot spot",
            "Linkage group",
            "Gene cluster"
        ],
        correctAnswer: 2,
        reasoning: "The Book theory State that all linked genes on a homologous pair of chromosomes form a Linkage Group."
    },
    {
        question: "The primary mechanism by which linkage between genes is broken, and new combinations of alleles (recombinants) are created, is known as:",
        options: [
            "Independent assortment",
            "Random fertilization",
            "Crossing Over",
            "Mutation"
        ],
        correctAnswer: 2,
        reasoning: "The Book theory State that Crossing Over is the exchange of genetic material between homologous chromosomes during prophase I of meiosis, which breaks linkage and creates new combinations of alleles (recombinants)."
    },
    {
        question: "Recombination frequency is a quantitative measure of the genetic distance separating linked genes. A higher recombination frequency between two genes directly indicates what about their chromosomal positioning?",
        options: [
            "They are located on different chromosomes.",
            "They are located closer together on the same chromosome.",
            "They are located farther apart on the same chromosome.",
            "They are completely linked and never separate."
        ],
        correctAnswer: 2,
        reasoning: "The Book theory State that a higher recombination frequency indicates greater distance between linked genes."
    },
    {
        question: "A genetic map, or linkage map, is an ordered list of genetic loci along a chromosome. The distances on these maps are determined by recombination frequencies, expressed in units. What are these units called?",
        options: [
            "Base pairs",
            "Nanometers",
            "Map Units (Centimorgans)",
            "Allelic frequencies"
        ],
        correctAnswer: 2,
        reasoning: "The Book theory State that genetic map distances are expressed in Map Units (Centimorgans, cM), where 1 map unit = 1% recombination frequency."
    },
    {
        question: "Desmopressin is a synthetic hormone used to treat mild Haemophilia A. Its therapeutic action involves stimulating the production of which specific clotting factor?",
        options: [
            "Factor I",
            "Factor VIII",
            "Factor IX",
            "Factor XI"
        ],
        correctAnswer: 1,
        reasoning: "The Book theory State that Desmopressin treats mild Haemophilia A by stimulating factor VIII production."
    },
    {
        question: "The general mechanism of blood clotting involves a complex cascade of reactions. This cascade specifically involves a known set of factors. How many distinct clotting factors are typically involved in this series of reactions?",
        options: [
            "Five",
            "Eight",
            "Thirteen",
            "Twenty"
        ],
        correctAnswer: 2,
        reasoning: "The Book theory State that the blood clotting cascade involves a complex series of reactions involving 13 known clotting factors (Factor I to XIII)."
    },
    {
        question: "After fibrin is formed into thin strands, it proceeds to create a meshwork. What is the critical immediate function of this fibrin meshwork in the process of clot formation?",
        options: [
            "To activate more platelets.",
            "To convert prothrombin to thrombin.",
            "To trap blood cells, forming a solid clot.",
            "To dissolve existing clots."
        ],
        correctAnswer: 2,
        reasoning: "The Book theory State that fibrin strands form a meshwork that traps blood cells, forming a solid clot."
    },
    {
        question: "In Mendelian genetics, the term 'heredity' refers to the transmission of characteristics from parents to offspring. Which fundamental component is responsible for controlling these hereditary characteristics?",
        options: [
            "Proteins",
            "Carbohydrates",
            "Genes",
            "Lipids"
        ],
        correctAnswer: 2,
        reasoning: "The Book theory State that genes control hereditary characteristics."
    },
    {
        question: "Mendel's work remained unrecognized for 34 years after its publication. Besides the preoccupation with Darwin's theory, what other factor contributed to the early neglect of his findings?",
        options: [
            "His results were contradictory to existing beliefs.",
            "He failed to publish his work in reputable journals.",
            "Lack of familiarity with statistical analysis among biologists.",
            "His experiments were not reproducible."
        ],
        correctAnswer: 2,
        reasoning: "The Book theory State that Mendel's work was unrecognized for 34 years due to biologists' preoccupation with Darwin's theory (1859), and lack of familiarity with statistical analysis."
    },
    {
        question: "The genetic complement, representing the actual alleles an individual possesses for a specific trait, is termed the:",
        options: [
            "Phenotype",
            "Karyotype",
            "Genotype",
            "Linkage group"
        ],
        correctAnswer: 2,
        reasoning: "The Book theory State that genotype is the genetic complement; the actual alleles an individual possesses for a trait."
    },
    {
        question: "In a monohybrid cross, the F1 generation always consists of individuals that are heterozygous. If such an F1 individual is self-fertilized, what percentage of the F2 offspring would be expected to be phenotypically identical to the F1 parent, assuming complete dominance?",
        options: [
            "25%",
            "50%",
            "75%",
            "100%"
        ],
        correctAnswer: 2,
        reasoning: "The Book theory State that in a monohybrid cross, F1 individuals are heterozygous and show the dominant phenotype. In the F2, the phenotypic ratio is 3 dominant:1 recessive. Therefore, 75% of the F2 offspring will exhibit the dominant phenotype, which is phenotypically identical to the F1 parent."
    },
    {
        question: "The Law of Independent Assortment states that alleles of different gene pairs assort independently. This principle is directly applicable when considering genes located on:",
        options: [
            "The same chromosome, very close together",
            "The same chromosome, exhibiting complete linkage",
            "Different homologous chromosomes, or far apart on the same chromosome",
            "Sex chromosomes only"
        ],
        correctAnswer: 2,
        reasoning: "The Book theory State that the Law of Independent Assortment applies because genes are either on different homologous chromosomes or far apart on the same chromosome."
    },
    {
        question: "A dihybrid cross between two true-breeding parents (RRYY x rryy) yields an F1 generation that is uniformly RrYy. If these F1 individuals are self-fertilized, the F2 generation will exhibit several phenotypic combinations. Which phenotypic combinations in the F2 are specifically referred to as 'recombinant' phenotypes?",
        options: [
            "Only the RRYY and rryy combinations",
            "Only the RrYy combination",
            "Combinations like Rryy and rrYy, not seen in the initial parents",
            "All combinations showing at least one dominant trait"
        ],
        correctAnswer: 2,
        reasoning: "The Book theory State that the F2 generation of a dihybrid cross also produces new 'recombinant' phenotypes not seen in parents, which would be combinations like Rryy and rrYy if R and Y were the original dominant parental types."
    },
    {
        question: "Considering a scenario where two independent genetic events occur. Event A has a probability of 0.5, and Event B has a probability of 0.25. According to the product rule, what is the joint probability of both Event A and Event B occurring simultaneously?",
        options: [
            "0.75",
            "0.25",
            "0.125",
            "0.05"
        ],
        correctAnswer: 2,
        reasoning: "The Book theory State that the 'product rule' states that the joint probability of two independent events occurring simultaneously is the product of their individual probabilities. (0.5 * 0.25 = 0.125)."
    },
    {
        question: "Morgan's *Drosophila* eye color experiments demonstrated X-linked inheritance. If a heterozygous red-eyed female (XR Xr) is crossed with a red-eyed male (XR Y), what proportion of their female offspring would be expected to carry the white-eye allele but still express the red-eye phenotype?",
        options: [
            "0%",
            "25%",
            "50%",
            "75%"
        ],
        correctAnswer: 2,
        reasoning: "The Book theory State that females (XX) can be homozygous or heterozygous. In the cross XR Xr x XR Y, the female offspring genotypes would be XR XR and XR Xr (50% each). Therefore, 50% of female offspring would be heterozygous carriers (XR Xr) and thus phenotypically red-eyed."
    },
    {
        question: "In X-linked recessive inheritance, if an affected father has children with a homozygous dominant unaffected mother, what is the expected genetic status of their daughters?",
        options: [
            "All daughters will be affected.",
            "All daughters will be unaffected carriers.",
            "All daughters will be homozygous dominant and unaffected.",
            "Half of the daughters will be affected, and half will be carriers."
        ],
        correctAnswer: 1,
        reasoning: "The Book theory State that with an affected father, all daughters are carriers because they inherit his X chromosome carrying the recessive allele, while the mother provides a dominant allele making them heterozygous and phenotypically normal carriers."
    },
    {
        question: "A research study identifies a genetic disorder where an affected mother has a 50% chance of passing the mutation to any child, and an affected father transmits the trait to all his daughters but none of his sons. This inheritance pattern is characteristic of:",
        options: [
            "Autosomal recessive inheritance",
            "X-linked recessive inheritance",
            "Y-linked inheritance",
            "X-linked dominant inheritance"
        ],
        correctAnswer: 3,
        reasoning: "The Book theory State that X-linked dominant inheritance is characterized by an affected mother having a 50% chance of passing the mutation to any child, and an affected father having all daughters affected but no sons affected."
    },
    {
        question: "Deviation from expected Mendelian ratios, such as a 1:1:1:1 ratio in a dihybrid test cross, is a primary indicator for the detection of:",
        options: [
            "Polygenic inheritance",
            "Incomplete dominance",
            "Gene Linkage",
            "Multiple allelism"
        ],
        correctAnswer: 2,
        reasoning: "The Book theory State that deviations from expected Mendelian ratios (e.g., 1:1:1:1 in a dihybrid test cross) are used for the detection of Gene Linkage."
    },
    {
        question: "If two genes are completely linked, meaning they are inherited together without any recombination, what would be the expected outcome in a dihybrid test cross involving these genes?",
        options: [
            "Only recombinant types would be observed.",
            "Only parental types would be observed.",
            "An equal proportion of parental and recombinant types.",
            "A 9:3:3:1 phenotypic ratio."
        ],
        correctAnswer: 1,
        reasoning: "The Book theory State that complete linkage shows only parental types, as there is no crossing over to produce recombinants."
    },
    {
        question: "Haemophilia A is an X-linked recessive disorder. If a carrier female (XHXh) and a normal male (XHY) have offspring, what is the probability that they will have an affected son?",
        options: [
            "0%",
            "25%",
            "50%",
            "75%"
        ],
        correctAnswer: 1,
        reasoning: "The Book theory State that in X-linked recessive inheritance, a carrier female (XHXh) has a 50% chance of passing the Xh allele to her sons. Since sons also have a 50% chance of being male (inheriting Y from father), the probability of an affected son (XhY) is 0.5 (from mother) * 0.5 (being male) = 0.25 or 25%."
    },
    {
        question: "Octocogalfa is a genetically engineered purified factor VIII. This treatment is specifically designed for individuals suffering from which type of haemophilia?",
        options: [
            "Haemophilia A",
            "Haemophilia B",
            "Haemophilia C",
            "Von Willebrand disease"
        ],
        correctAnswer: 0,
        reasoning: "The Book theory State that Octocogalfa, a genetically engineered purified factor VIII, treats Haemophilia A."
    },
    {
        question: "The initial response to a cut blood vessel involves activated platelets and damaged tissue releasing chemicals. These chemicals then interact with other chemicals and proteins in the plasma. What are these plasma components collectively known as?",
        options: [
            "Antibodies",
            "Hormones",
            "Clotting factors",
            "Enzymes"
        ],
        correctAnswer: 2,
        reasoning: "The Book theory State that activated platelets and damaged tissue release chemicals, which react with other chemicals and proteins in plasma, known as clotting factors."
    },
    {
        question: "Considering Mendel's careful methodology, why was developing 'true/pure breeding lines' for his pea plant experiments a crucial initial step?",
        options: [
            "To induce genetic mutations for new traits.",
            "To ensure consistent phenotypes in the parental generation for predictable crosses.",
            "To facilitate cross-pollination between different varieties.",
            "To identify environmental influences on trait expression."
        ],
        correctAnswer: 1,
        reasoning: "The Book theory State that Mendel's methodology included developing true/pure breeding lines. This was crucial to ensure that parents would consistently pass on specific traits, making the outcome of crosses predictable and allowing for the observation of segregation and independent assortment of alleles without interference from unknown heterozygosity in the parental stock."
    },
    {
        question: "A plant breeder observes a new trait in their crop that consistently skips a generation before reappearing in the F2 with a 3:1 ratio after self-crossing the F1. This pattern is indicative of a characteristic that requires which genetic condition for its expression in F2?",
        options: [
            "Heterozygous dominance",
            "Homozygous recessive",
            "Hemizygous expression",
            "Complete linkage"
        ],
        correctAnswer: 1,
        reasoning: "The Book theory State that a recessive trait/allele is masked in F1 but reappears in F2 with a 3:1 phenotypic ratio. It requires homozygous condition for expression (except in hemizygous males). Thus, the reappearance in F2 indicates homozygous recessive expression."
    },
    {
        question: "If an organism is heterozygous for two unlinked genes (e.g., AaBb), how many distinct types of gametes, based on these two genes, can it produce according to the Law of Independent Assortment?",
        options: [
            "One type (AB)",
            "Two types (AB, ab)",
            "Four types (AB, Ab, aB, ab)",
            "Eight types (AABB, AABb, AAbb, etc.)"
        ],
        correctAnswer: 2,
        reasoning: "The Book theory State that the Law of Independent Assortment means alleles of different gene pairs assort independently during gamete formation. For AaBb, the gametes would be AB, Ab, aB, and ab, which are four distinct types."
    },
    {
        question: "Morgan's observation that *all* white-eyed flies in the F2 generation were male led to the conclusion that the eye color gene is X-linked. If, hypothetically, the gene for eye color were located on an autosome instead, what would be the expected sex distribution of white-eyed flies in the F2 generation?",
        options: [
            "All white-eyed flies would still be male.",
            "All white-eyed flies would be female.",
            "White-eyed flies would be equally distributed between males and females.",
            "No white-eyed flies would appear in the F2 generation."
        ],
        correctAnswer: 2,
        reasoning: "The Book theory State that if the gene were autosomal, its inheritance would not be linked to sex. Therefore, any phenotypic ratio (like 3:1) would be observed equally in both male and female offspring, leading to an equal distribution of white-eyed flies between sexes in the F2 generation."
    },
    {
        question: "In the context of X-linked recessive disorders like haemophilia, why are females generally carriers and phenotypically normal, maintaining the faulty allele in the population, rather than being commonly affected?",
        options: [
            "They only inherit X chromosomes from their mothers.",
            "They have two X chromosomes, one often masking the recessive allele.",
            "Their Y chromosome compensates for the faulty allele.",
            "They undergo paternal X inactivation, suppressing the faulty allele."
        ],
        correctAnswer: 1,
        reasoning: "The Book theory State that females are usually carriers (heterozygous) and phenotypically normal because they have two X chromosomes. If one X carries the recessive allele, the other X often carries a dominant normal allele, which masks the expression of the recessive one."
    },
    {
        question: "Two genes, A and B, are known to be linked on the same chromosome. During a dihybrid test cross, it is observed that the frequency of recombinant offspring is 30%. What is the genetic distance between these two genes, expressed in map units (centimorgans)?",
        options: [
            "3 map units",
            "70 map units",
            "30 map units",
            "Cannot be determined without knowing the parental types"
        ],
        correctAnswer: 2,
        reasoning: "The Book theory State that 1 map unit (Centimorgan, cM) equals 1% recombination frequency. Therefore, a 30% recombination frequency corresponds to a genetic distance of 30 map units or 30 cM."
    },
    {
        question: "Considering the detailed mechanism of blood clotting, which specific substance is responsible for forming the structural meshwork that physically traps blood cells to create a solid clot?",
        options: [
            "Fibrinogen",
            "Prothrombin",
            "Thrombin",
            "Fibrin"
        ],
        correctAnswer: 3,
        reasoning: "The Book theory State that the final step involves converting Factor I (fibrinogen, a soluble protein) into thin strands of solid protein called fibrin, and these fibrin strands then form a meshwork that traps blood cells, forming a solid clot."
    },
    {
        question: "If a genetic disorder is inherited as an autosomal recessive trait, which of the following is most likely to be true about affected individuals?",
        options: [
            "They must have at least one affected parent.",
            "They can have unaffected parents who are both carriers.",
            "They are more commonly male than female.",
            "They will pass the disorder to all of their children."
        ],
        correctAnswer: 1,
        reasoning: "The Book theory State that autosomal recessive traits like Haemophilia C require a homozygous recessive condition for expression. This means an affected individual (aa) can have two unaffected parents who are both heterozygous carriers (Aa), each contributing an 'a' allele."
    },
    {
        question: "The concept of pseudoautosomal genes refers to X-Y linked genes present on both X and Y chromosomes. What distinguishing characteristic do these genes share in their inheritance pattern?",
        options: [
            "They follow a strictly X-linked recessive pattern.",
            "They are only expressed in males.",
            "They follow autosomal inheritance patterns.",
            "They are always completely linked and never recombine."
        ],
        correctAnswer: 2,
        reasoning: "The Book theory State that X-Y linked (Pseudoautosomal genes) are genes present on both X and Y, and they follow autosomal inheritance patterns."
    },
    {
        question: "Which of the following is NOT listed as a reason for Mendel's success with pea plants?",
        options: [
            "Easy to grow in pots or open ground.",
            "Possesses distinct contrasting heritable characters.",
            "Long life cycle requiring extensive observation.",
            "Self-pollinating flowers, but cross-pollination possible."
        ],
        correctAnswer: 2,
        reasoning: "The Book theory State that one of the reasons for Mendel's success with pea plants was their short life cycle, not a long one."
    },
    {
        question: "In a dihybrid cross, new 'recombinant' phenotypes appear in the F2 generation. These arise because alleles of different gene pairs assort independently. This independent assortment specifically occurs because:",
        options: [
            "Homologous chromosomes always pair up identically during meiosis.",
            "Genes are always located very close together on the same chromosome.",
            "Genes are either on different homologous chromosomes or far apart on the same chromosome.",
            "Crossing over always occurs between all linked genes."
        ],
        correctAnswer: 2,
        reasoning: "The Book theory State that the Law of Independent Assortment occurs because genes are either on different homologous chromosomes or far apart on the same chromosome."
    },
    {
        question: "What is the genotype of an individual that expresses a dominant trait but is shown to produce offspring with a recessive phenotype when crossed with a homozygous recessive individual?",
        options: [
            "Homozygous dominant",
            "Heterozygous",
            "Homozygous recessive",
            "Hemizygous dominant"
        ],
        correctAnswer: 1,
        reasoning: "The Book theory State that a test cross (dominant phenotype x homozygous recessive) reveals the genotype. If the dominant individual is heterozygous, offspring will show a 1:1 ratio of dominant:recessive phenotypes. The appearance of recessive offspring indicates the dominant parent must be heterozygous to carry the recessive allele."
    },
    {
        question: "In the genetic study of *Drosophila*, the observation of giant chromosomes in salivary glands is advantageous for what specific reason?",
        options: [
            "They allow for easier DNA extraction.",
            "They provide structural detail for easy study of chromosomal organization.",
            "They enable direct observation of protein synthesis.",
            "They are easier to mutate for genetic screens."
        ],
        correctAnswer: 1,
        reasoning: "The Book theory State that one reason for *Drosophila* as a model organism is the presence of giant chromosomes in salivary glands for easy study."
    },
    {
        question: "Which of the following scenarios in an X-linked recessive disorder would lead to a carrier female having an affected son?",
        options: [
            "She inherits the recessive allele from her father.",
            "She inherits the recessive allele from her mother.",
            "She inherits the recessive allele from both parents.",
            "She passes her X chromosome carrying the recessive allele to her son."
        ],
        correctAnswer: 3,
        reasoning: "The Book theory State that a carrier female (heterozygous) has a 50% chance of passing the X-linked recessive mutation to her offspring. If she passes this X chromosome to a son (who only receives a Y from his father), that son will be affected."
    },
    {
        question: "If two linked genes have a recombination frequency of 0%, what would this imply about their relative positions on the chromosome?",
        options: [
            "They are on different chromosomes.",
            "They are very far apart on the same chromosome.",
            "They are completely linked and inherited as a single unit.",
            "They are undergoing frequent crossing over."
        ],
        correctAnswer: 2,
        reasoning: "The Book theory State that complete linkage shows only parental types, meaning a 0% recombination frequency, indicating the genes are inherited together as a single unit, implying they are extremely close or inseparable in terms of recombination."
    },
    {
        question: "A patient is diagnosed with a bleeding disorder where blood fails to clot properly due to a deficiency in clotting factor IX. Based on the given information, which specific type of haemophilia is indicated?",
        options: [
            "Haemophilia A",
            "Haemophilia B",
            "Haemophilia C",
            "Von Willebrand's factor deficiency"
        ],
        correctAnswer: 1,
        reasoning: "The Book theory State that Haemophilia B is caused by disturbance/deficiency of clotting factor IX."
    },
    {
        question: "The complex series of reactions involving 13 known clotting factors, where each reaction triggers the next, is best described as a:",
        options: [
            "Linear pathway",
            "Positive feedback loop",
            "Clotting cascade",
            "Homeostatic mechanism"
        ],
        correctAnswer: 2,
        reasoning: "The Book theory State that the blood clotting mechanism involves a complex series of reactions involving 13 known clotting factors (Factor I to XIII), referred to as a cascade."
    },
    {
        question: "In the F2 generation of a monohybrid cross, the phenotypic ratio is 3:1 (dominant:recessive), and the genotypic ratio is 1:2:1 (homozygous dominant:heterozygous:homozygous recessive). This specific outcome is a direct consequence of which fundamental Mendelian principle operating during gamete formation in the F1 parents?",
        options: [
            "Law of Dominance",
            "Law of Independent Assortment",
            "Law of Segregation",
            "Complete Linkage"
        ],
        correctAnswer: 2,
        reasoning: "The Book theory State that the Law of Segregation (Purity of Gametes) dictates that the two coexisting alleles for each trait in an individual segregate from each other during meiosis, so each gamete receives only one of the two alleles. This segregation of alleles from heterozygous F1 parents (e.g., Rr to R and r gametes) is what ultimately leads to the 1:2:1 genotypic and 3:1 phenotypic ratios in the F2 generation after random fertilization."
    }
];

// Constants
const QUIZ_ACCESS_CODE = "PreMium-A-12345";
const DEV_ACCESS_CODE = "Dev-WCW-001";
const ACADEMY_NAME = "WHITE COAT WORRIORS ";
const QUIZ_SUBJECT = "Inheritance";
const WEBSITE_LINK = "https://premiumdoctoracademy.com";
const WHATSAPP_CONTACT = "03287743851";
const WHATSAPP_COMMUNITY = "https://whatsapp.com/channel/0029VaFCIU6EquiOlXWcNR1X";
const TIME_PER_MCQ = 60;
const MARK_PER_MCQ = 1;
const NEGATIVE_MARKING = 0;

// Global state variables
let currentQuizId = 'WCW-BIO-04';
let quizData = quizData_WCW_BIO_04;
let currentQuestion = 0;
let userAnswers = Array(quizData.length).fill(null);
let timeLeft;
let questionTimeLeft;
let totalTimeInterval;
let questionTimeInterval;
let studentData = {};
let studentAccessCode = "";

// DOM elements
const questionNavEl = document.getElementById('question-nav');
const questionTextEl = document.getElementById('question-text');
const optionsContainerEl = document.getElementById('options-container');
const reasoningEl = document.getElementById('reasoning');
const reasoningTextEl = document.getElementById('reasoning-text');
const quizTitleEl = document.getElementById('quiz-title');
const quizSubjectEl = document.getElementById('quiz-subject');
const perMcqTimeEl = document.getElementById('per-mcq-time');
const totalTimerEl = document.getElementById('timer');
const questionTimerEl = document.getElementById('question-timer');
const quizProgressEl = document.getElementById('quiz-progress');
const studentInfoTable = document.getElementById('student-info-table');
const quizResultsTable = document.getElementById('quiz-results-table');
const allMcqsList = document.getElementById('all-mcqs-list');
const devPasswordInput = document.getElementById('developerPassword');
const devErrorBox = document.getElementById('dev-error-box');
const quizAccessCodeInput = document.getElementById('quizAccessCode');
const quizAccessErrorBox = document.getElementById('quiz-error-box');
const toggleDevPasswordIcon = document.getElementById('toggleDeveloperPassword');
const toggleQuizCodeIcon = document.getElementById('toggleQuizAccessCode');
const websiteLinkEl = document.getElementById('website-link');
const whatsappContactLinkEl = document.getElementById('whatsapp-contact-link');
const whatsappCommunityLinkEl = document.getElementById('whatsapp-community-link');
const reasoningBtn = document.getElementById('reasoning-btn');
const quizNotificationEl = document.getElementById('quiz-notification');
const notificationTitleEl = document.getElementById('notification-title');
const notificationMessageEl = document.getElementById('notification-message');
const notificationYesBtn = document.getElementById('notification-yes');
const notificationNoBtn = document.getElementById('notification-no');
const correctCountEl = document.getElementById('correct-count');
const incorrectCountEl = document.getElementById('incorrect-count');
const unansweredCountEl = document.getElementById('unanswered-count');
const performanceFillEl = document.getElementById('performance-fill');


/**
 * @description Sends data to the Google Apps Script endpoint.
 * @param {object} data - The payload containing type ('registration' or 'quiz_result') and data.
 */
function sendDataToSheet(data) {
    if (!SHEET_SCRIPT_URL || SHEET_SCRIPT_URL.includes('YOUR_DEPLOYED_WEB_APP_URL')) {
        console.error('SHEET_SCRIPT_URL is not configured. Data not sent to Google Sheet.');
        return Promise.resolve({ success: false, message: 'Script URL not configured.' });
    }

    return fetch(SHEET_SCRIPT_URL, {
        method: 'POST',
        // 'no-cors' is necessary for Apps Script to accept cross-origin POST requests from a web page
        mode: 'no-cors',
        cache: 'no-cache',
        headers: {
            'Content-Type': 'application/json',
        },
        body: JSON.stringify(data)
    })
    .then(response => {
        // Cannot read response body with 'no-cors', assume request was sent successfully
        return { success: true, message: 'Request sent to Google Script.' };
    })
    .catch(error => {
        console.error('Sheet Data Send Error:', error);
        return { success: false, message: 'Failed to send request to Google Script.' };
    });
}


// Initialization
document.addEventListener('DOMContentLoaded', () => {
    const storedStudentData = localStorage.getItem('studentData');
    if (storedStudentData) {
        studentData = JSON.parse(storedStudentData);
        document.getElementById('studentName').value = studentData['Student Name'] || '';
        document.getElementById('fatherName').value = studentData['Father Name'] || '';
        document.getElementById('email').value = studentData['Email'] || '';
        document.getElementById('mobile').value = studentData['Mobile'] || '';
        document.getElementById('city').value = studentData['City'] || '';
    }
    const storedCode = localStorage.getItem('studentAccessCode');
    if (storedCode) {
        studentAccessCode = storedCode;
    }
    
    showPage('signin-page');
    
    if (toggleDevPasswordIcon) toggleDevPasswordIcon.addEventListener('click', () => togglePasswordVisibility('developerPassword', 'toggleDeveloperPassword'));
    if (toggleQuizCodeIcon) toggleQuizCodeIcon.addEventListener('click', () => togglePasswordVisibility('quizAccessCode', 'toggleQuizAccessCode'));
});

function showQuizNotification(title, message, type = 'info') {
    const allowedNotifications = ['Registration Successful', 'Access Granted', 
                                 'Quiz Completed!', 'Quiz Reset', 'Registration Error', 'Submission Error', 'Registration Warning'];
    
    if (!allowedNotifications.includes(title)) {
        return;
    }
    
    notificationTitleEl.textContent = title;
    notificationMessageEl.textContent = message;
    
    quizNotificationEl.classList.remove('warning', 'error');
    
    if (type === 'warning') {
        quizNotificationEl.classList.add('warning');
    } else if (type === 'error') {
        quizNotificationEl.classList.add('error');
    }
    
    quizNotificationEl.classList.add('show');
    
    setTimeout(() => {
        if (quizNotificationEl.classList.contains('show')) {
            hideQuizNotification();
        }
    }, 5000);
}

function hideQuizNotification() {
    quizNotificationEl.classList.remove('show');
}

function showPage(pageId) {
    const pages = document.querySelectorAll('.page');
    pages.forEach(page => page.classList.remove('active'));
    document.getElementById(pageId).classList.add('active');
    document.querySelectorAll('.error-box, .success-box').forEach(el => el.style.display = 'none');
}

function togglePasswordVisibility(inputID, iconID) {
    const passwordInput = document.getElementById(inputID);
    const toggleIcon = document.getElementById(iconID);
    
    if (passwordInput.type === 'password') {
        passwordInput.type = 'text';
        toggleIcon.classList.remove('fa-eye-slash');
        toggleIcon.classList.add('fa-eye');
    } else {
        passwordInput.type = 'password';
        toggleIcon.classList.remove('fa-eye');
        toggleIcon.classList.add('fa-eye-slash');
    }
}

function showQuizAccessForm() {
    document.getElementById('quiz-access-form').style.display = 'flex';
    document.getElementById('developer-access-form').style.display = 'none';
}

function showDeveloperAccessForm() {
    document.getElementById('developer-access-form').style.display = 'flex';
    document.getElementById('quiz-access-form').style.display = 'none';
}

function showRegistrationPage() {
    showPage('registration-page');
}

// Registration Handler
function generateAccessCode(studentName, fatherName) {
    const studentInitials = studentName.split(' ').map(n => n[0]).join('').toUpperCase();
    const fatherInitials = fatherName.split(' ').map(n => n[0]).join('').toUpperCase();
    const uniqueId = Math.random().toString(36).substring(2, 7).toUpperCase();

    return `${ACADEMY_NAME.replace(/\s+/g, '-')}-${studentInitials}${fatherInitials}-${uniqueId}`;
}

function handleRegistration() {
    const sName = document.getElementById('studentName').value.trim();
    const fName = document.getElementById('fatherName').value.trim();
    const email = document.getElementById('email').value.trim();
    const mobile = document.getElementById('mobile').value.trim();
    const city = document.getElementById('city').value.trim();
    
    if (!sName || !fName || !email || !mobile || !city) {
        showQuizNotification('Registration Error', 'Please fill in all the registration details.', 'error');
        return;
    }
    
    // Generate access code
    const generatedCode = generateAccessCode(sName, fName);
    studentAccessCode = generatedCode;

    studentData = {
        'Student Name': sName,
        'Father Name': fName,
        'Email': email,
        'Mobile': mobile,
        'City': city
    };

    // --- NEW: SEND REGISTRATION DATA TO GOOGLE SHEET ---
    const registrationDataToSend = {
        type: 'registration',
        accessCode: generatedCode,
        studentName: sName,
        fatherName: fName,
        email: email,
        mobile: mobile,
        city: city
    };
    
    sendDataToSheet(registrationDataToSend)
        .then(response => {
            console.log('Sheet Registration Response:', response);
            showQuizNotification('Registration Successful', `Your code: ${generatedCode}. Data submitted to sheet.`, 'info');
        })
        .catch(error => {
            console.error('Sheet Registration Error:', error);
            showQuizNotification('Registration Warning', `Registration saved locally, but sheet submission failed.`, 'warning');
        });
    // ----------------------------------------------------
    
    // Store data locally
    localStorage.setItem('studentAccessCode', generatedCode);
    localStorage.setItem('studentData', JSON.stringify(studentData));
    
    const registrations = JSON.parse(localStorage.getItem('wcwRegistrations') || '[]');
    registrations.push({
        ...studentData,
        accessCode: generatedCode,
        timestamp: new Date().toISOString()
    });
    localStorage.setItem('wcwRegistrations', JSON.stringify(registrations));
    
    
    // Start the quiz after registration
    startQuiz('WCW-BIO-04', 'Student', generatedCode);
}

// Quiz Access Handler
function checkDeveloperPassword() {
    devErrorBox.style.display = 'none';
    if (devPasswordInput.value === DEV_ACCESS_CODE) {
        showQuizNotification('Access Granted', 'Welcome! You have successfully logged in as a developer.', 'info');
        startQuiz('WCW-BIO-04', 'Developer', DEV_ACCESS_CODE);
    } else {
        devErrorBox.style.display = 'block';
    }
}

function accessQuiz(inputCode) {
    const errorBox = document.getElementById('quiz-error-box');
    errorBox.style.display = 'none';
    
    const storedStudentCode = localStorage.getItem('studentAccessCode');
    
    if (inputCode === QUIZ_ACCESS_CODE || inputCode === DEV_ACCESS_CODE || inputCode === storedStudentCode) {
        showQuizNotification('Access Granted', 'Welcome! You can now start the quiz.', 'info');
        startQuiz('WCW-BIO-04', 'Student', inputCode);
    } else {
        errorBox.style.display = 'block';
    }
}

function startQuiz(quizId, userType, code) {
    currentQuizId = quizId;
    quizData = quizData_WCW_BIO_04;
    
    // Always start fresh - no progress restoration
    currentQuestion = 0;
    userAnswers = Array(quizData.length).fill(null);
    
    timeLeft = quizData.length * TIME_PER_MCQ;
    questionTimeLeft = TIME_PER_MCQ;
    
    localStorage.setItem('lastAccessCode', code);

    showPage('quiz-page');
    initQuiz();
}

// Quiz Logic
function initQuiz() {
    quizSubjectEl.textContent = QUIZ_SUBJECT;
    perMcqTimeEl.textContent = Math.floor(TIME_PER_MCQ / 60);
    
    websiteLinkEl.href = WEBSITE_LINK;
    whatsappContactLinkEl.href = 'https://wa.me/' + WHATSAPP_CONTACT;
    whatsappCommunityLinkEl.href = WHATSAPP_COMMUNITY;
    
    quizTitleEl.textContent = `Test - ID: ${currentQuizId}`;
    renderQuestionNav();
    renderQuestion();

    if (totalTimeInterval) clearInterval(totalTimeInterval);
    if (questionTimeInterval) clearInterval(questionTimeInterval);
    
    totalTimeInterval = setInterval(updateTotalTimer, 1000);
    questionTimeInterval = setInterval(updateQuestionTimer, 1000);
}

function updateTotalTimer() {
    if (timeLeft > 0) {
        timeLeft--;
        const minutes = Math.floor(timeLeft / 60);
        const seconds = timeLeft % 60;
        totalTimerEl.textContent = `${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
    } else {
        clearInterval(totalTimeInterval);
        submitTest(true);
    }
}

function updateQuestionTimer() {
    if (questionTimeLeft > 0) {
        questionTimeLeft--;
        questionTimerEl.textContent = `${questionTimeLeft}`;
    } else {
        questionTimeLeft = TIME_PER_MCQ;
        navigateQuestion('next');
    }
}

function renderQuestionNav() {
    questionNavEl.innerHTML = '';
    quizData.forEach((_, index) => {
        const navItem = document.createElement('div');
        navItem.classList.add('question-nav-item');
        navItem.textContent = index + 1;
        navItem.onclick = () => navigateQuestion(index);
        
        if (index === currentQuestion) {
            navItem.classList.add('current');
        } else if (userAnswers[index] !== null) {
            navItem.classList.add('solved');
        } else if (userAnswers.slice(0, index).some(ans => ans !== null) || index < currentQuestion) {
             navItem.classList.add('visited');
        }
        
        questionNavEl.appendChild(navItem);
    });
    updateProgressBar();
}

function updateProgressBar() {
    const solvedCount = userAnswers.filter(answer => answer !== null).length;
    const progress = (solvedCount / quizData.length) * 100;
    quizProgressEl.style.width = `${progress}%`;
}

function renderQuestion() {
    reasoningEl.style.display = 'none';
    reasoningBtn.classList.add('disabled');
    const question = quizData[currentQuestion];
    questionTextEl.textContent = `${currentQuestion + 1}. ${question.question}`;
    
    optionsContainerEl.innerHTML = '';
    question.options.forEach((option, index) => {
        const optionEl = document.createElement('div');
        optionEl.classList.add('option');
        optionEl.textContent = option;
        
        const isAnswered = userAnswers[currentQuestion] !== null;

        if (!isAnswered) {
            optionEl.onclick = () => selectOption(index);
        } else {
            if (index === question.correctAnswer) {
                optionEl.classList.add('correct');
            } else if (index === userAnswers[currentQuestion]) {
                optionEl.classList.add('incorrect');
            }
        }
        
        if (userAnswers[currentQuestion] === index) {
            optionEl.classList.add('selected');
        }

        optionsContainerEl.appendChild(optionEl);
    });
    
    questionTimeLeft = TIME_PER_MCQ;
    questionTimerEl.textContent = `${questionTimeLeft}`;
    renderQuestionNav();
    
    if (userAnswers[currentQuestion] !== null) {
        reasoningBtn.classList.remove('disabled');
    }
}

function selectOption(optionIndex) {
    const question = quizData[currentQuestion];
    userAnswers[currentQuestion] = optionIndex;
    
    reasoningBtn.classList.remove('disabled');
    
    const options = optionsContainerEl.querySelectorAll('.option');
    options.forEach((option, index) => {
        option.onclick = null;
        option.classList.remove('selected', 'correct', 'incorrect');
        
        if (index === question.correctAnswer) {
            option.classList.add('correct');
        } else if (index === optionIndex) {
            option.classList.add('incorrect');
        }
        
        if (index === optionIndex) {
             option.classList.add('selected');
        }
    });

    renderQuestionNav();
    
    setTimeout(() => {
        navigateQuestion('next');
    }, 800);
}

function navigateQuestion(direction) {
    const totalQuestions = quizData.length;
    let nextIndex;

    if (typeof direction === 'number') {
        nextIndex = direction;
    } else if (direction === 'next') {
        nextIndex = (currentQuestion + 1) % totalQuestions;
    } else if (direction === 'prev') {
        nextIndex = (currentQuestion - 1 + totalQuestions) % totalQuestions;
    } else {
        return;
    }

    if (nextIndex === currentQuestion) return;
    
    currentQuestion = nextIndex;
    renderQuestion();
}

function toggleReasoning() {
    if (reasoningBtn.classList.contains('disabled')) return;
    
    const question = quizData[currentQuestion];
    if (reasoningEl.style.display === 'block') {
        reasoningEl.style.display = 'none';
    } else {
        reasoningTextEl.textContent = question.reasoning;
        reasoningEl.style.display = 'block';
    }
}

function submitTest(isTimeout = false) {
    if (!isTimeout && !confirm('Are you sure you want to submit the quiz?')) {
        return;
    }
    
    clearInterval(totalTimeInterval);
    clearInterval(questionTimeInterval);

    let correct = 0;
    let incorrect = 0;
    let unanswered = 0;

    quizData.forEach((question, index) => {
        if (userAnswers[index] === null) {
            unanswered++;
        } else if (userAnswers[index] === question.correctAnswer) {
            correct++;
        } else {
            incorrect++;
        }
    });

    const totalQuestions = quizData.length;
    const totalScore = (correct * MARK_PER_MCQ) - (incorrect * NEGATIVE_MARKING);
    const totalMarks = totalQuestions * MARK_PER_MCQ;

    correctCountEl.textContent = correct;
    incorrectCountEl.textContent = incorrect;
    unansweredCountEl.textContent = unanswered;
    
    const performancePercentage = (correct / totalQuestions) * 100;
    performanceFillEl.style.width = `${performancePercentage}%`;

    const savedStudentData = JSON.parse(localStorage.getItem('studentData') || '{}');
    const lastAccessCode = localStorage.getItem('lastAccessCode') || 'N/A';
    
    let studentInfoHtml = '';
    for (const [key, value] of Object.entries(savedStudentData)) {
        studentInfoHtml += `<tr><td>${key}</td><td>${value}</td></tr>`;
    }
    studentInfoHtml += `<tr><td>Access Code Used</td><td>${lastAccessCode}</td></tr>`;
    studentInfoTable.innerHTML = studentInfoHtml;

    quizResultsTable.innerHTML = `
        <tr><td>Quiz ID</td><td>${currentQuizId}</td></tr>
        <tr><td>Total Questions</td><td>${totalQuestions}</td></tr>
        <tr><td>Correct Answers</td><td>${correct}</td></tr>
        <tr><td>Incorrect Answers</td><td>${incorrect}</td></tr>
        <tr><td>Unanswered</td><td>${unanswered}</td></tr>
        <tr><td>Your Score</td><td>${totalScore} / ${totalMarks}</td></tr>
    `;

    // --- NEW: SEND QUIZ RESULTS TO GOOGLE SHEET ---
    if (lastAccessCode && lastAccessCode !== 'N/A') {
        const resultsDataToSend = {
            type: 'quiz_result',
            accessCode: lastAccessCode,
            quizId: currentQuizId,
            totalQuestions: totalQuestions,
            correct: correct,
            incorrect: incorrect,
            unanswered: unanswered,
            totalScore: totalScore,
            totalMarks: totalMarks,
            studentName: savedStudentData['Student Name'] || 'Unknown' 
        };

        sendDataToSheet(resultsDataToSend)
            .then(response => {
                console.log('Sheet Results Update Response:', response);
            })
            .catch(error => {
                console.error('Sheet Results Update Error:', error);
                showQuizNotification('Submission Error', 'Failed to send results to the server sheet.', 'error');
            });
    }
    // ----------------------------------------------------


    const results = JSON.parse(localStorage.getItem('wcwQuizResults') || '[]');
    results.push({
        studentName: savedStudentData['Student Name'] || 'Unknown',
        accessCode: lastAccessCode,
        quizId: currentQuizId,
        totalQuestions: totalQuestions,
        correct: correct,
        incorrect: incorrect,
        unanswered: unanswered,
        totalScore: totalScore,
        totalMarks: totalMarks,
        timestamp: new Date().toISOString()
    });
    localStorage.setItem('wcwQuizResults', JSON.stringify(results));
    
    showQuizNotification('Quiz Completed!', `Your score: ${totalScore}/${totalMarks}. Check the results page for details.`, 'info');
    
    showPage('results-page');
}

function restartTest() {
    if (confirm('Are you sure you want to retake the full test? Your current progress will be lost.')) {
        quizData = quizData_WCW_BIO_04;
        currentQuestion = 0;
        userAnswers = Array(quizData.length).fill(null);
        timeLeft = quizData.length * TIME_PER_MCQ;
        
        showPage('quiz-page');
        initQuiz();
    }
}

function retakeIncorrect() {
    const incorrectIndices = quizData.map((question, index) => {
        const isIncorrect = userAnswers[index] !== null && 
                            userAnswers[index] !== question.correctAnswer;
        return isIncorrect ? index : -1;
    }).filter(index => index !== -1);
    
    if (incorrectIndices.length === 0) {
        showQuizNotification('No Incorrect Questions', 'You have no incorrect questions to retake!', 'info');
        return;
    }
    
    quizData = incorrectIndices.map(index => quizData_WCW_BIO_04[index]);
    currentQuestion = 0;
    userAnswers = Array(quizData.length).fill(null);
    timeLeft = quizData.length * TIME_PER_MCQ;
    
    showPage('quiz-page');
    initQuiz();
}

function viewAllMcqs() {
    allMcqsList.innerHTML = '';
    quizData_WCW_BIO_04.forEach((question, index) => {
        const mcqItem = document.createElement('div');
        mcqItem.classList.add('all-mcq-item');
        mcqItem.innerHTML = `
            <div class="question-text">${index + 1}. ${question.question}</div>
            <div class="all-mcq-options">
                ${question.options.map((option, optIndex) => `
                    <div class="all-mcq-option ${optIndex === question.correctAnswer ? 'correct' : ''}">
                        ${option}
                    </div>
                `).join('')}
            </div>
            <div class="all-mcq-reasoning">
                <strong>Reasoning:</strong> ${question.reasoning}
            </div>
        `;
        allMcqsList.appendChild(mcqItem);
    });
    showPage('all-mcqs-page');
}</script>